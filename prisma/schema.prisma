generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum Role {
  MAHASISWA
  ADMIN
  KAPRODI
}

enum SubmissionStatus {
  TERKIRIM
  DIPERIKSA_ADMIN
  DITOLAK_ADMIN
  DIPROSES_KAPRODI
  DISETUJUI
}

enum Jurusan {
  MATEMATIKA
  SISTEM_INFORMASI
}

model User {
  id             Int             @id @default(autoincrement())
  email          String          @unique
  password       String
  role           Role
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  studentProfile StudentProfile?
}

model StudentProfile {
  id          Int                @id @default(autoincrement())
  userId      Int                @unique
  user        User               @relation(fields: [userId], references: [id])
  nim         String             @unique
  fullName    String
  jurusan     Jurusan
  submissions ThesisSubmission[]
}

model ThesisSubmission {
  id                Int              @id @default(autoincrement())
  studentId         Int
  student           StudentProfile   @relation(fields: [studentId], references: [id])
  jurusan           Jurusan // Kolom ini penting untuk filtering
  topik             String
  judul             String
  status            SubmissionStatus @default(TERKIRIM)
  catatanAdmin      String?          @db.Text
  transkripUrl      String?
  uktUrl            String?
  konsultasiUrl     String?
  usulanPembimbing1 String
  usulanPembimbing2 String
  usulanPembimbing3 String?
  pembimbing1       String?
  pembimbing2       String?
  skPembimbingUrl   String?
  createdAt         DateTime         @default(now())
  updatedAt         DateTime         @updatedAt
}

model Dosen {
  id      Int     @id @default(autoincrement())
  nama    String
  jurusan Jurusan
}